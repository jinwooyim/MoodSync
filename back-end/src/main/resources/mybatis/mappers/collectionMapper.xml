<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
    
<mapper namespace="com.boot.collection.dao.CollectionDAO">
    <insert id="insertCollection" parameterType="com.boot.collection.dto.CollectionDTO">
        INSERT INTO collections (collectionId, userId, name, description, isPublic) 
        VALUES (
            (SELECT NVL(MAX(collectionId), 0) + 1 FROM collections),
            #{userId},   -- DTO의 userId 필드와 매핑
            #{name},
            #{description},
            #{isPublic}
        )
    </insert>

    <update id="updateCollection" parameterType="com.boot.collection.dto.CollectionDTO">
        UPDATE collections
        SET name=#{name}, description=#{description}, isPublic=#{isPublic}, updatedAt=SYSTIMESTAMP 
        WHERE collectionId=#{collectionId}
    </update>
    <delete id="deleteCollection" parameterType="long">
        DELETE FROM collections WHERE collectionId=#{id} 
    </delete>
    <select id="selectCollection" parameterType="long" resultType="com.boot.collection.dto.CollectionDTO">
        SELECT collectionId, userId, name, description, isPublic, createdAt, updatedAt -- 컬럼 명시적 지정 권장
        FROM collections
        WHERE collectionId=#{id}
    </select>
    <select id="selectAllCollections" resultType="com.boot.collection.dto.CollectionDTO">
        SELECT collectionId, userId, name, description, isPublic, createdAt, updatedAt -- 컬럼 명시적 지정 권장
        FROM collections
    </select>
</mapper>